# 第一章  误差

## 数值分析的研究对象与特点

研究数值问题与计算方法

1. 将计算机不能直接计算的运算，化成在计算机上可执行的运算；
2. 针对数值问题研究可在计算机上执行且行之有效的新系列计算公式；
3. **误差分析**，及研究数值问题和数值方法的稳定性；

## 误差

### 误差的来源与分类

1. 模型误差
2. 观测误差
3. **截断误差**：由于数学模型本身求解的就是近似解带来的误差（理论）
4. **舍入误差**：数据在计算机上存放时产生的误差（计算）

### 绝对误差与相对误差

​		绝对误差：$ e = x - x^* $ 

​		绝对误差限：$\vert e \vert <= \epsilon  $

​		相对误差：$e_r = \frac{x-x^*}{x} = \frac{x-x^*}{x*}$

​		相对误差限：$\vert e_r\vert = \vert \frac{e}{x^*}\vert<=\epsilon_r$

​		$ \epsilon = \epsilon_r*x^*$               $e = e_r*x^* $

### 有效数字

- 表示近似值的**大小**与**精度**

非零小数总可写成：

​		$x^* = \pm0.\alpha_1\alpha_2.....\alpha_n \times 10^m$  其中：
​        $\epsilon = \vert x-x^*\vert\le0.5\times10^{m-n} $      	$\epsilon_r = \frac{1}{2\alpha_1}\times10^{-n+1} $                                                                          	    若$\epsilon_r\le\frac{1}{2(\alpha_1+1)}\times10^{-n+1}$，则$x^*$至少有$n$位有效数字

### 算数运算中的误差

- 绝对误差：$e(y^*)\approx df(x_1^*,x_2^*,...,x_n^*)=\sum_{i=1}^n \frac{\partial f(x_1^*,x_2^*,...,x_n^*)}{\partial x_i}e(x_i^*)$
- 相对误差：$e(y^*)\approx d(\ln{f}) = \sum_{i=1}^n\frac{\partial f(x_1^*,x_2^*,...,x_n^*)}{\partial x_i}\frac{x_i^*}{f(x_1^*,x_2^*,...,x_n^*)}e_r(x_i^*)$
- 和、差的==绝对==误差是各自绝对误差之和、差
- 积、商的==相对==误差是各自相对误差之和、差

## 数值计算中应注意的问题

### 原则

1. 避免两个相近的数相减
2. 防止大数吃小数
3. 避免除数绝对值远小于被除数绝对值的除法
4. 先化简在计算，减少运算次数，避免误差积累
5. 选用稳定的算法（减小舍入误差）

### 转换公式

- 当$x\rightarrow0$时，有：
  $1-\cos{x} = 2\sin^2{x/2}$    $(1-\cos{x})/sin{x} = \sin{x}/(1+\sin{x})$

- 当$x\rightarrow\infty$时，有：

  $\sqrt{x+1}-\sqrt{x} = \frac{1}{\sqrt{x+1}+\sqrt{x}}$        **$\frac{1}{x}-\frac{1}{x+1} = \frac{1}{x(x+1)}$**

## 误差配置原则

### 误差配置原理

​    总误差 = 截断误差 + 舍入误差，即$\varepsilon = R  + \in $
​	==最为合理的误差分配是$R=\in$==

### 按$R=\in$配置的有关方法

1. 给定运算误差$\in$，确定参与运算的数值的==**字长**==
2. 近似式的**项数已定**而**字长待定**
3. 总误差已定，求项数和字长
4. 已知字长求项数

# 第二章  方程(组)的迭代解法

研究问题：

1. 根的初值的确定方法
2. 迭代法的求解过程
3. 迭代法的收敛性
4. 迭代序列的误差估计

## 迭代解法

### 根的初值的确定方法

==定理2.1==    设$f(x)$为区间$[a,b]$上的**单值连续函数**，若有$f(a)f(b)<0$，则：$[a,b]$中至少有一个实根

1. 画图法
2. 扫描法
3. 对分（二分）法

### 求解过程

思路：把$f(x) = 0$等价变换为$x=\varphi(x)$

1. 把$f(x)=0$转换为$x=\varphi(x)$
2. 从初值$x_0$出发，按迭代函数$x_{n+1} = \varphi(x_n)$进行计算

### 迭代法的收敛性

#### 收敛条件

==定理2.2==    若：(1) $\varphi(x)$在==包含根==$\alpha$的区间$[a,b]$上可微
						  (2)$\vert\varphi^`(x)\vert\le q<1,x\in[a,b]$, 其中==$q=max\vert\frac{x_{k+1}-a}{x_k-a}\vert(k=0,1,...,n)$==
				  则：对任何$x_0\in[a,b]$,迭代过程$x_n+1= φ(x_n )$一定收敛

==定理2.3==    若：(1) $\varphi(x)$在区间$[a,b]$上连续
						  (2)$|\varphi(x_1)-\varphi(x_2)|\le L|x_1-x_2|  (0\le L\le1)$
				  则：对任何$x_0\in[a,b]$, 迭代过程$x_{n+1}=\varphi(x_n)$一定收敛

​	收敛阶数：$\lim_{n\to\infty}\frac{|x_{n+1}|-\alpha}{|x_n-\alpha|^r} = c$
​		r为收敛阶数，反应迭代过程收敛速度的快慢		
​			r=1,线性收敛; r=2,平方收敛; r>1, 超线性收敛

==定理2.4==    若：(1)$\varphi(x)$在根$\alpha$附近有$r$阶连续导数
						  (2)$\varphi^`(\alpha)=\varphi^{``}(\alpha)=...\varphi^{r-1}(\alpha)==0,及\varphi^{(r)}(\alpha)\neq0$
				  则：迭代过程$x_{n+1}=\varphi(x_n)$是$r$阶收敛的
	该定理提供了**测定收敛阶**的方法

## 迭代序列的误差估计

### 迭代终止条件

​		$|x_{n+1}-\alpha|<\varepsilon$ , $x_{n+1}$即为所求得的近似值。($\varepsilon$是绝对误差限)

### 引申迭代终止条件(上界公式)

#### 上界公式1：$|x_{n+1}-\alpha|\le\frac{q}{1-q}|x_{n+1}-x_n|$

1. 当$0<q<0.5$时, 只需$|x_{n+1}-\alpha|<\in$即可保证$|x_{n+1}-\alpha|<\varepsilon$
2. 当$q>0.5$时, 需$|x_{n+1}-x_n|\le\frac{1-q}{q}\in$才能满足~
3. 当$q>1$时，会出现假收敛的情况

#### 上界公式2：$|x_n-\alpha|\le\frac{q^n}{1-q}|x_1-x_0|$

该公式可用于预估迭代次数n

#### 上界公式3：$|x_n-\alpha|\le\frac{|f(x_n)|}{m},0<m\le|f^`(x)|,x\in[a,b]$

## 迭代公式改进

### 引入可选参数法

​	将原本求根方程转化为：$x = \frac{1}{1-\theta}[\varphi(x)-\theta x]=\psi(x)$
​	则有：$\psi^`(x) = \frac{1}{1-\theta}[\varphi^`(x)-\theta]$
​	要使$|\psi^`(x)|$尽量小,则取$\theta=\varphi^`(x),x\approx \alpha$
​	建立迭代公式如下：

​			==$x_{n+1}=\frac{1}{1-\theta}[\varphi(x_n)-\theta x_n]$==

​	埃特肯加速方法本质就是求更合适的$\theta$

### 埃特肯加速法

​	每次迭代都包含三次迭代计算:

1. 求$x_{n-1}$的一次相邻迭代值$y_n$
2. 求$x_{n-1}$的两次相邻迭代值$z_n$
3. 用$x_{n-1},y_n.z_n$的变化率代替$\theta$

​	最终迭代公式为:  ==$x_{n+1}=\frac{1}{1-\theta_n}[\varphi(x_n)-\theta_n x_n]$==  $\theta_n = \frac{z_n-y_n}{y_n-x_{n-1}}$

​	或者：==$\Large x_{n+1}=\frac{x\varphi(\varphi(x))-[\varphi(x)]^2}{x-2\varphi(x)+\varphi(\varphi(x))}$==

​	埃特肯加速法的几何意义即为用直线代替曲线去做趋近

### 引入参数$\lambda$

​	原本公式变为：$x = x-\lambda f(x)=\varphi(x)$
​	做估计：$对x\in[a,b], 0<m\le f^`(x)\le M$
​	取$\lambda = \frac{1}{f^,(x)}$, $f^,(x)=(m+M)/2$
​	所以有迭代公式：

​	==$\Large x_{n+1} = x_n - \frac{2}{m+M}f(x_n)$==

​	实际上:$\lambda = \frac{1}{1-\theta} , \theta=1-\frac{1}{\lambda}$

### 牛顿迭代法

​	实质：将$\lambda$改为变值，即令：$\lambda = \frac{1}{f^`(x)}$
​	所以有迭代公式：

​	==$x_{n+1} = x_n-\frac{f(x_n)}{f^`(x_n)}$==

​	几何意义是用切线取逼根（埃特肯是割线）

==定理2.5==  若：

1. $f(a)f(b)<0$
2. $f^`(x)\neq0$
3. $f^{``}(x)$不变号
4. 初值$x_0$满足$f(x_0)f^{``}(x_0)>0$

​		则：牛顿迭代法收敛

### 牛顿下山法

​	在牛顿迭代法公式的基础上再引入一个$\lambda$，并修改$\lambda$的值（即改变切线的斜率），使得下山条件$|f(x_n)|>|f(x_{n+1})|$成立。

​	迭代公式：==$x_{n+1}=\lambda(x_n-\frac{f(x_n)}{f^`(x_n)})+(1-\lambda)x_n$==

​	如果不满足下山条件就修改$\lambda$的值直到下山条件成立

### 弦截法

#### 单点弦截法

​	用平均变化率替代$f^`(x_n)$
​	==$x_{n+1}=x_n-\frac{f(x_n)(x_n-x_0)}{f(x_n)-f(x_0)}$==

​	实际上是以初值为定点不断做割线，来逼近真实根

​	若单点弦截法满足定理2.5并且$f(x_1)f(x_0)<0$,则收敛

#### 双点弦截法

​	就是把单点弦截法的$x_0$换成$x_{n-1}$
​	==$x_{n+1}=x_n-\frac{f(x_n)(x_n-x_{n-1})}{f(x_n)-f(x_{n-1})}$==

​	双点弦截法的收敛只需要满足：
​		1. $f^`(x),f^{``}(x)存在$; 2. $f(a)f(b)<0$; 3. $f^,(x)\neq0$

### $|\varphi^`(x_n)|>1$的处理方法

​	核心思想：取$\varphi(x)$的反函数$\psi(x)$, 使得$|\psi^`(x)|<1$，则$x_{n+1}=\psi(x_n)$进行迭代必收敛

# 第三章 解线性方程组的直接法

​	若系数矩阵A的行列式$|A|\neq0$, 则线性方程组的解唯一

​	目前有两种计算机上常用且有效的方法：消元法 和 主元素法

## 消元法

​	一般来说，消元法就是一个把系数矩阵变为上三角矩阵的过程

**消元过程**

​	消元过程中，每行的消元过程本质相同。所以下面只会给出第$i$行的消元。

1. 经历了前$i-1$次消元后，第$i$行变为:
   $\sum^{n}_{j=i}(a_{ij}-\sum^{i-1}_{j=1}l_{ij}u_{ji})x_j=b_i-\sum^{i-1}_{k=1}l_{ik}z_k$
2. 自己选定一个$l_{ii}$，式子两边同时除以$l_{ii}$，就能得到$u_{ij}$和$z_i$
   那么有：==$\Large u_{ij}=\frac{a_{ij}-\sum^{i-1}_{j=1}l_{ij}u_{ji}}{l_{ii}} (i\ge j)$== 上三角矩阵
       ==$\Large l_{ij}=\frac{a_{ij}-\sum^{j-1}_{k=1}l_{ik}u_{kj}}{u_{jj}}(i\le j)$==    下三角矩阵 
        ==$\Large z_i=\frac{b_i-\sum^{i-1}_{k=1}l_{ik}z_k}{l_{ii}}$==

**回代过程**
	由消元过程可以得到上三角矩阵U和下三角矩阵L，并可得:
		UX=Z  LZ=B  又有AX=B，得：

​		==$\Large x_i=\frac{z_i-\sum^n_{k=i+1}u_{ik}x_k}{u_{ii}}$==

### 高斯消元法

​	核心：取==$l_{ii}=1$==的消元法

###  克劳特消元法

​	核心：取==$u_{ii}=1$==的消元法

### 平方根法

​	注意：系数矩阵为对称矩阵才可用此法

​	核心：在取$l_{ii}$时使得$u_{ii}=l_{ii}$，即:==$l_{ii}=\sqrt{a_{ii}-\sum^{i-1}_{k=1}l^2_ik} (i=j)$==，这样会使得$u_{ij}=l_{ji}$

### 追赶法

​	核心：用==克劳特消元法==求解==三对角线形==的线性方程组的解

### 消元法的应用条件

==定理1== 若A的各阶主子式均不为0，即==$l_{ii}\neq0,u_{ii}\neq0$==,消元法可用

==定理2== 若A为**实对称正定矩阵**，则消元法可用

==定理3== 若A为**强对角优势矩阵**，则消元法可用
	强对角优势矩阵：满足$|a_{ii}|>\sum^{n}_{j=1,j\neq i}|a_{ij}|$

## 主元素法

​	目的：控制舍入误差
​	主元素：==绝对值==最大的元素

### 列主元素法

​	核心：在列中选取主元素，并通过行变换将主元素置于对角线位置

​	方法：对于**第k列**，将主元素所在行与**第k行**进行交换，然后消元

### 全主元素法

​	核心：在全体中选取主元素，并通过交换将其置于对角线第一个位置

# 第四章 解线性方程组的迭代法

基本思想：将$AX=b$变为等价的方程组$X=BX+f$
	并由此建立迭代公式：	$X^{(k+1)}=BX^{(k)}+f$

## 向量范数，矩阵范数，谱半径及有关性质

### 范数

#### 范数的定义

​	一个与某一向量X对应的实数，记为$||X||$, 满足以下三个性质：

1. $||X||\ge0$; $||X||=0$当且仅当X=0
2. 对任意实数$\alpha$, 都有$||\alpha X|| = |\alpha|||X||$
3. 对任意向量Y，都有$||X+Y||\le ||X||+||Y||$

#### 三种常用的向量范数

1. 1-范数：$||X||_1=\sum^n_{i=1}|x_i|$
2. 2-范数：$||X||_2=\sqrt{x_1^2+x_2^2+...+x_n^2}=(\sum^n_{i=1}x_i^2)^{\frac{1}{2}}$
3. $\infty$-范数：$||X||_{\infty}=max_{1\le i\le n}\{|x_i|\}$

#### 几点说明

​	向量范数可以用来衡量向量的==大小==和表示向量的==误差==

#### 矩阵范数

​		一个与某一矩阵A对应的实数，记为$||A||$, 满足以下四个性质：

1. $||A||\ge0$; $||A||=0$当且仅当A=0
2. 对任意实数$\alpha$, 都有$||\alpha A|| = |\alpha|||A||$
3. 对任意向量Y，都有$||A+B||\le ||A||+||B||$
4. $||AB||\le||A||||B||$

#### 矩阵范数与向量范数的关系

​	若：$||AX||_{\alpha}\le||A||_{\beta}||X||_{\alpha}$，则称矩阵范数$||A||_{\beta}$和向量范数$||X||_{\alpha}$==相容==

​	矩阵的算子范数：$||A||_{\nu}=max_{||X||_{\nu}=1}||AX||_{\nu}$  ，则右式为A的算子范数

 1. 列范数：A的列向量中的1-范数最大值~$||A||_1$
 2.  行范数：A的行向量中的1-范数最大值~$||A||_{\infty}$
 3.  $||A||_2=\sqrt{\lambda_{max}(AA^`)}$, 其中$\lambda_{max}$是$AA^,$的最大特征值
 4.  F-范数：$||A||_F=\sqrt{\sum^n_{i,j=1}{a^2_{ij}}}$，与2-范数相容

### 向量收敛

#### 定义

​	$lim_{k\to\infty}{||X^{(K)}-X||}=0$或$\lim_{k\to\infty}X^{(k)}=X$

#### 向量收敛的充分必要条件

​	$\lim_{k\to\infty}x_j^{(K)}=x_j(j=1,2,...,n)$

#### 方阵收敛的定义

​	$lim_{k\to\infty}{||A^{(K)}-A||}=0$或$\lim_{k\to\infty}A^{(k)}=A$

#### 方阵收敛的充分必要条件

​	$\lim_{k\to\infty}a_{ij}^{(K)}=a_{ij}(i,j=1,2,...,n)$

#### 谱半径

​	$\rho(A)$即为矩阵的==绝对值最大==的特征值，	$\rho(A)\le||A||$

​	矩阵的谱半径小于等于矩阵的任何一种范数

#### 谱范数

定理4.4    如果$A\in R^{n\times n}$，则
 	1) $||A||_2=\sqrt{\lambda_{max}(AA^`)}=\sqrt{\rho(AA^`)}$
 	2) 若A为对称矩阵，则$||A||_2=\rho(A)$

​	此时成$||A||_2$为谱范数

 ==方阵收敛的充分必要条件是$\rho(A)<1$==

## 简单（雅可比）迭代法

​	将$AX=B$进行变换：$X=(I-A)X+B=CX+B$  ==$C=I-A$==

​	迭代公式为：$X^{k+1}=CX^{(K)}+B$

### 方法

1. 把方程组的每一行左边都只留下$x_{ii}$，即得：
   $\large x_i=b_i-\sum^n_{j=1，j\neq i}a_{ij}x_j=\sum^n_{j=1}g_{ij}x_j+f_i$
2. 得到矩阵G和F，有$g_{ij}=-\frac{a_{ij}}{a_{ii}},f_i=b_i/a_{ii}$
   X=GX+F
3. 迭代公式变为：$x^{k+1}_i=\sum^n_{j=1}g_{ij}x^k_j+f_i$

### 误差估计式

$\large ||X^{(k)}-x^*||\le \frac{||M||^k}{1-||M||}||X^{(1)}-X^{(0)}||$

### 收敛条件

==定理== 对任何初始向量和$X^{(0)}$和常数项N，有迭代公式：$X^{(k+1)}=MX^{(k)}+N$，向量序列${X^{(k)}}$收敛的充要条件为：==$\rho(M)<1$==

1. M的行范数小于1（$\infty-$范数）
2. M的列范数小于1（1-范数）
3. M的F-范数小于1

设允许误差为$\varepsilon$，当满足$||X^{(k)}-X^{(j-1)}||\le\frac{1-||M||}{||M||}\varepsilon$时，迭代即可停止

==定理== 若系数矩阵A不可约且弱严格对角占优，则雅可比迭代法必定收敛

## 赛德尔迭代法

核心：迭代矩阵为$(I-M_1)^{-1}M_2$的简单迭代法

### 迭代方法

实际上，将简单迭代法中已经求出来的$x_i$即使更新到下一次求值中，即把$x^{k+1}_i=\sum^n_{j=1}g_{ij}x^k_j+f_i$变为==$x^{(k+1)}_i=\sum^{i-1}_{j=1}g_{ij}x^{(k+1)}_j+\sum^n_{j=i+1}g_{ij}x^k_j+f_i$==

矩阵形式：$X^{(k+1)}=M_1X^{(k+1)}+M_2X^{(k)}+N$
						$M=(I-M_1)^{-1}M_2$

### 收敛条件

1. M的行范数小于1（$\infty-$范数）
2. M的列范数小于1（1-范数）
3. M的F-范数小于1

==定理==   若系数矩阵A不可约且对角占优，则赛德尔迭代法必定收敛

## 松弛迭代法

### 方程的残差

​	设$x_1,x_2,...,x_n$为$\alpha_1,\alpha_2,...,\alpha_n$的近似值，记$r_i=b_i-(a_{i1}x_1+a_{i2}x_2+...+a_{in}x_n)$。则称$r_i$为线性方程组第i个方程的残差

### 松弛

​	修改某个方程中的一个变量，使该方程的残差为0。称为松弛。
​	一般来说，对于第i个方程，一般修改第i个变量

### 按$|r_i|$最大实施松弛方法

对于第i个方程，有：

​	$\large r_i^{(k)}=\frac{b_i}{a_{ii}}-x_i^{(k)}-\sum^{n}_{j=1,j\neq i}\frac{a_{ij}}{a_{ii}}x_j^{(k)}$    $b_{ij}=\frac{a_{ij}}{a_{ii}},c_i=\frac{b_i}{a_{ii}}$

即：	==$\large r_i^{(k)}=c_i-x_i^{(k)}-\sum^{n}_{j=1,j\neq i} b_{ij}x_j^{(k)}$==

1. 按照初值得到0次残差，并设$|r_s^{(k)}|=\max_i|r_i^{(k)}|$
2. 令$x_i^{(k+1)}=x_i^{(k)}+r_i^{(k)}$，得：$r_i^{(k+1)}=r_i^{(k)}+b_{is}r_s^{(k)}$
3. 直至**修正量**小于精度，松弛停止

### 按方程次序实施松弛的方法

​	逐次松弛法，完全等同于赛德尔迭代法

### 带有松弛因子的逐次迭代法

迭代方法：

1. 把逐次松弛法(赛德尔迭代法)的迭代公式写为：
   $\large x_i^{(k+1)}=x_1^{(k)}-\frac{1}{a_{11}}[a_{i1}^{(k)}+a_{i2}^{(k)}+...+a_{in}x_n^{(k)}-b_i]=x_i^{(k)}+\sigma x_i^{(k)}$
2. 引入一个松弛因子$\omega$，用$\omega\sigma x_i^{(k)}$代替$\sigma x_i^{(k)}$来计算$x_i^{(k+1)}$的值
3. 即==$\large x_i^{(k+1)}=(1-\omega)x_i^{(k)}+\omega[\sum^{i-1}_{j=1}(-\frac{a_{ij}}{a_{ii}})x_j^{(k+1)}+\sum^n_{j=i+1}(-\frac{a_{ij}}{a_{ii}})x_j^{(k)}+\frac{b_i}{a_{ii}}]$==

​	实际上就是把$x_i^{(k+1)}$加权$\omega$，$x_i^{(k)}$加权$(1-\omega)$

### 松弛法的收敛条件

收敛的==必要条件==：$0<\omega<2$
若A为对称正定矩阵，且$0<\omega<2$时，松弛法恒收敛
若A为不可约、对角占优矩阵，且$0<\omega\le1$时，松弛法必定收敛

# 第五章 插值法

## 不等距条件下的牛顿基本插商公式

### 差商

区间$[x_i,x_{i+1},...,x_{i+n}]$上的n阶差商为：
		$\Large f[x_i,x_{i+1},...,x_{i+n}]=\frac{f[x_{i+1},...,x_{i+n-1}]-[x_{i},...,x_{i+n-1}]}{x_{i+n}-x_i}$

差商具有对称性，即差商的值与同族节点排列的次序无关
当$f(x)=P_n(x)$为n次多项式时，可以证明它的n阶差商是一个常量

### 牛顿基本差商公式

$f(x)=P_n(x)+R_n(x)$，其中$P_n(x)$为差商公式，$R_n(x)$为余式

$$P_n(x)=f[x_0]+(x-x_0)f[x_1,x_0]+(x-x_1)(x-x_0)f[x_2,x_1,x_0]+...
+(x-x_0)(x-x_1)...(x-x_n)f[x_n,...,x_1,x_0]$$

$R_n(x)=(x-x_0)(x-x_1)...(x-x_n)f[x,x_n,...x_1,x_0]$

**差商和导数的关系**：$\large f[x_0,x_1,..,x_n]=\frac{f^{(n)}(\xi)}{n!}$

### 余式的估计：

$\large R_n(x)\le\frac{M_{n+1}}{(n+1)!}|\Pi^n_{i=0}(x)|$

事后估计误差：$\large R_n(x)=\frac{x-x_0}{x_0-x_{n+1}}[P_n(x)-P^{(1)}_n(x)]$

## 等距条件下的牛顿差商公式

### 差分

==前提：等距节点==

定义   在等距节点$[x_{i-1},...,x_{i+n-1}]$n阶差分：$\Large \Delta^ny_{i-1}=\Delta^{n-1}y_i-\Delta^{n-1}y_{i-1}$

设插值间距为h，则有：$\Large f[x_0,x_1,x_2]=\frac{\Delta^2y_0}{2!h^2}$

### 牛顿前向插值公式

将$\large f[x_i,x_{i+1},...,x_{i+n}]=\frac{\Delta^ny_i}{n!h^n}$带入牛顿基本差商公式中，并令$t=\frac{x-x_0}{h}，x-x_i=(t-i)h$，得：

$\large P_n(x)=y_0+t\frac{\Delta y_0}{1!}+t(t-1)\frac{\Delta^2y_0}{2!}+...+t(t-1)...(t-n+1)\frac{\Delta^ny_0}{n!}$

再令$\large c_t^i=\frac{t(t-1)...(t-i+1)}{i!}=\frac{t^{[i]}}{i!}$，最终得：

==$\Large P_n(x)=y_0+c_t^1\Delta y_0+c_t^2\Delta^2 y_0+...+c_t^n\Delta^n y_0$==

余项公式：

$\large R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}h^{n+1}t(t-1)...(t-n)$

### 牛顿后向插值公式

基本过程与前向插值相同，只不过是从下往上插值，插值序列顺序相反

$t=\frac{x-x_n}{h}$

令$\large c_t^i=\frac{t(t+1)...(t+i-1)}{i!}$，最终得：

==$\Large P_n(x)=y_n+c_t^1\Delta y_{n-1}+c_t^2\Delta^2 y_{n-2}+...+c_t^n\Delta^n y_0$==

余项公式：

$\large R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}h^{n+1}t(t+1)...(t+n)$

## 不等距节点下的拉格朗日插值

### 插值公式

思路：根据差商公式求f(x)

令$\large l_i(x)=\frac{(x-x_0)...(x-x_{i-1})(x-x_{i+1})...(x-x_n)}{(x_i-x_0)...(x_i-x_{i-1})(x_i-x_{i+1})...(x_i-x_n)}$，得：

==$\Large L_n(x)=\sum^n_{i=0}l_i(x)f(x_i)$==

==$\Large R_n(x)=(x-x_0)(x-x_1)...(x-x_n)f[x_0,x_1,...,x_n,x]$==

### 系数表达式

除了上面的写法外，$l_i(x)$也可以写成如下的形式：

- $\Large l_i(x)=\Pi^n_{j=0,j\neq i}\frac{x-x_j}{x_j-x_i}$
- $\large l_i(x)=\frac{(x-x_0)...(x-x_{i-1})(x-x_{i+1})...(x-x_n)}{(x_i-x_0)...(x_i-x_{i-1})(x_i-x_{i+1})...(x_i-x_n)}$

### 舍入误差

$\large |\in|\le\sum^n_{i=0}(|\Delta y_i||l_i(x)|+|\Delta l_i||y_i|)$

当拉格朗日插值公式中有负系数出现时，会放大$y_i$的舍入误差。

## 等距节点下的拉格朗日插值

因为节点等距，所以可得：

$\Large l_i(x)=\frac{(-1)^{(n-i)}t(t-1)...(t-i+1)(t-i-1)...(t-n-1)}{i!(n-i)!}f(x_i)$

==$\Large  L_n(x)=\sum^n_{i=0}l_i(x)f(x_i)$==

### 分段线性插值

实质就是$n=1$的拉格朗日插值

### 等距三点插值

实质是$n=2$的拉格朗日插值

## 插值公式的唯一性及其应用

### 唯一性

若插值节点相同，则插值公式唯一

### 插值公式的应用

#### 不等距节点

- 需要估算结果舍入误差时，使用拉格朗日插值
- 需要增加节点时用牛顿基本差商公式

#### 等距节点

- x靠近表头用牛顿前向插值
- x靠近表尾用牛顿后向插值

## 反插值

### 利用反函数的插值法

实际上就是把x和y互换

但只有在$y=f(x)$是单调函数时才能用

### 利用插值多项式的反插法

$\large x=x_0+\frac{y-f(x_0)}{f[x_1,x_0]+(x-x_1)f[x_2,x_1,x_0]+...+(x-x_1)(x-x_1)...(x-x_n)f[x_n,...,x_1,x_0]}$

上式与牛顿基本差商公式等价

## 埃尔米特插值多项式

构造的插值函数不仅在函数值上取值重合，还要求插值函数在**若干阶导数**也重合。

应满足：

- $\sum^m_{k=0}x_i^ka_k=y_i$
- $\sum^m_{k=1}kx_i^{k-1}=y_i^`$
- ...
- $\sum^m_{k=m_i}k(k-1)(k-2)...(k-m_i+1)x_i^{k-m_i}=y_i^{(m_i)}$

### 牛顿型埃尔米特插值公式

核心：差商和导数的关系$\large f[x_0,x_1,..,x_n]=\frac{f^{(n)}(\xi)}{n!}$

有：$\Large f[x_0,x_0,...,x_0]=\frac{f^{(n)}(x_0)}{n!},n+1个x_0$

所以，将每一个节点的个数都增加到导数阶+1个之后，该问题就变为了在n+1个互异节点组上的插值问题

### 降阶型埃尔米特公式

把高次插值多项式逐次转化为低次插值多项式的求取方法

### 拉格朗日型埃尔米特插值

要求插值多项式与$f(x)$在节点上具有相同函数值和一阶导数值

## 多元函数插值

先固定一个y值，然后计算z值。算完之后换y值，接着计算直至全部完成

# 第六章 数值积分

意图解决的问题：

- 被积函数的原函数不能用初等函数表示
- 被积函数的原函数过于复杂
- 被积函数以表格形式给出

基本思想：
	用简单函数近似代替被积函数，然后建立求积公式：
		$\int^b_af(x)dx\approx A_0f(x_0)+A_1f(x_1)+...+A_nf(x_n)=\sum^n_{i=0}A_if(x_i)$

## 牛顿-柯斯特求积公式

核心：令$A_i=\int^b_al_i(x)dx$，其中$l_i(x)$是拉格朗日插值公式中的系数

### 公式

若将区间$[a,b]$分为n段，$h=\frac{b-a}{n}$，令$x=a+th$，则有：

$\Large A_k=\frac{(b-a)(-1)^{n-k}}{k!(n-k)!n}\int^n_0\Pi^n_{j=0,j\neq k}(t-j)dt$

==$\Large I(f)\approx \sum^n_{k=0}A_kf(x_k)$==

### 柯斯特系数

==$\Large C_k^{(n)}=\frac{(-1)^{n-k}}{k!(n-k)!n}\int^n_0\Pi^n_{j=0,j\neq k}(t-j)dt$==

$\large C_k=C_{n-k}$，即柯斯特系数具有对称性

![image-20211121213915718](C:\Users\rainbow\AppData\Roaming\Typora\typora-user-images\image-20211121213915718.png)

### 截断误差

$\large R_n(f)=\frac{h^{n+2}}{(n+1)!}\int^b_af^{(n+1)}(\xi)\Pi^n_{j=0}(t-j)dt$

### 梯形公式

​    n=1时的牛顿-柯斯特求积公式
​	$I_(f)\approx \frac{b-a}{2}[f(a)+f(b)]$

### 辛普生公式

​	n=2时的牛顿-柯斯特求积公式
​	$I_(f)\approx \frac{b-a}{6}[f(a)+4f(\frac{a+b}{2})+f(b)]$

### 误差公式

定理：2n阶N-C公式至少具有2n+1阶代数精度

## 复化求积公式

### 复化梯形公式

将$[a,b]$区间分为M个小段，其中M+1个节点为$[x_0,x_1,...,x_M]$
对每一个小段分别运用梯形公式，有：$I(f_i)\approx \frac{h}{2}[f(x_i)-f(x_{i-1})]$
所以==$\large I(f)\approx h(\frac{1}{2}f_0+f_1+...+f_{M-1}+\frac{1}{2}f_M)$==
$\large R=-\frac{(b-a)^3}{12M^2}f^{``}(\xi)$

### 复化辛卜生公式

仍然是分段+运用求积公式
所以==$I(f)\approx \frac{h}{3}[(f_0+f_M)+4(f_1+f_3+...+f_{M-1})+2(f_2+f_4+...+f_{M-2})]$==
$R=-\frac{(b-a)^5}{180M^4}f^{(4)}(\xi)$

## 龙贝格法

复化梯形公式序列$T_1,T_2,T_4,T_{2^k}\to$辛卜生序列$S_1,S_2,S_4,S_{2^k}\to$柯斯特序列$C_1,C_2,C_4,C_{2^k}\to$龙贝格序列$R_1,R_2,R_4,R_{2^k}\to$龙贝格求积法

序列求法：

1. $\large T_1=\frac{b-a}{2}[f(a)+f(b)]$
2. $\large T_{2^k}=\frac{1}{2}T_{2^{k-1}}+h\sum^{2^{k-1}}_{i=1}f(a+(2i-1)h)$，其中$h=\frac{b-a}{2^k}$
3. $\large S_{2^k}=\frac{4}{4-1}T_{2^{k+1}}-\frac{1}{4-1}T_{2^k}$
4. $\large C_{2^k}=\frac{4^2}{4^2-1}S_{2^{k+1}}-\frac{1}{4^2-1}S_{2^k}$
5. $\large R_{2^k}=\frac{4^3}{4^3-1}C_{2^{k+1}}-\frac{1}{4^3-1}C_{2^k}$

