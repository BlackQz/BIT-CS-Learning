# 计算机网络

本课程的考试题面为英文，可以用中英文作答，因此对计网中各类概念的英文理解还是非常必要的

## 特别记录的概念

- 协议Protocols
- 服务Services
- 接口Interfaces
- 主干网 backbone



## 引论 Introduction

### 几个概念





## 数据链路层 Data Link Layer

<img src="计算机网络.assets/image-20210408172549922.png" alt="image-20210408172549922" style="zoom:67%;" />

### 功能

- 为网络层提供服务
  - 提供无确认的无连接服务 Unacknowledged connectionless service  
  - 提供有确认的无连接服务 Acknowledged connectionless service  
  - 提供有确认的面向连接服务 Acknowledged connection-oriented service  

- 链路管理

- 帧定界、帧同步、透明传输

- 流量控制

  发送方能力大于接收方能力，发送方需要控制速度

- 差错控制

  通常采用循环冗余校验CRC发现位错，用自动重传请求ARQ重传出错帧

### 成帧

帧 Frame：链路层的传输单元

帧同步 Frame synchronization：从二进制比特流中区分出帧的开始与终止

集中成帧的方法

- 字符计数法Character Count  

  在帧首指出帧的长度，但如果计数字段出错则之后会一直出错

  <img src="计算机网络.assets/image-20210408180445874.png" alt="image-20210408180445874" style="zoom:67%;" />

- 字符填充的首尾定界符法Flag byte with byte/Char stuffing  

  定界符表示一帧的开始与结束，需要转义字符ESC

  <img src="计算机网络.assets/image-20210408180828162.png" alt="image-20210408180828162" style="zoom:67%;" />

- 零比特填充的首尾标志法

  用01111110表示一个帧的开始与结束，当信息位存在连续5个1时，自动在其后插入0

  <img src="计算机网络.assets/image-20210408181209405.png" alt="image-20210408181209405" style="zoom:67%;" />

### 差错控制

发生比特差错

#### 纠错编码 error-correcting codes  

#### 检错编码 error-detecting codes   



## 介质访问控制子层 MAC

<img src="计算机网络.assets/image-20210414151754025.png" alt="image-20210414151754025" style="zoom:67%;" />

介质访问控制子层需要决定广播信道中信道分配

可分为

- 信道划分介质访问控制 Channel Partitioning  
- 随机访问介质访问控制 Random-access  
- 轮询访问介质访问控制 Controlled-access protocols  

### 随机访问 Random Access

核心思想：争用信道，胜利者获得信息发送权

#### 纯ALOHA协议

当网络中任意站点需要发送数据时，可以不进行任意检测就发送，如果在一段时间内发送节点未收到确认，则该站点认为传输过程中发生了冲突，**等待一段时间**后再重传数据

假设网络负载未G（T0时间内所有站点发送成功和未成功而重传的帧数），吞吐量S（T0时间内发送成功的平均帧数）为

<img src="计算机网络.assets/image-20210414154141212.png" alt="image-20210414154141212" style="zoom:67%;" />

当G=0.5时，S最大

#### 时隙ALOHA协议

从吞吐量来看，纯ALOHA协议效率很低，设计间隙ALOHA协议

将时间划分为当长的时隙slot，规定只有在时隙开始时才能发送数据，控制每个真可以在一个时隙内发送完毕

<img src="计算机网络.assets/image-20210414154806591.png" alt="image-20210414154806591" style="zoom:67%;" />

#### CSMA协议

载波侦听多路访问，每个站点发送前都先侦听一下公共信道，发现信道空闲后才发送

可分为

- 不坚持型CSMA

  - 如果忙，等待一段随机时间后再次侦听
  - 如果空闲，立刻发送

- 1坚持型CSMA

  - 如果忙，继续坚持侦听信道

  - 如果空闲，立刻发送
  - 如果检测到冲突，等待随机一段时间后发送

- p坚持型CSMA

  - 如果忙，继续坚持侦听信道
  - 如果空闲，则以p概率发送数据，1-p概率推迟到下一时隙，在下一时隙也以相同概率判断
  - 、

#### CSMA/CD协议

CSMA协议改进方案，适用于总线形网络或半双工网络。**不工作在无线LAN**

由于检测到碰撞的最长时间是传输时延的两倍，划分时隙如下

<img src="计算机网络.assets/image-20210414161158332.png" alt="image-20210414161158332" style="zoom:67%;" />

最小帧长度为

<img src="计算机网络.assets/image-20210414161424245.png" alt="image-20210414161424245" style="zoom:67%;" />



先听后发，边听边发，冲突停发，随机重发

- 适配器从网络层获得一个分组，封装成以太网帧，放入适配器缓存，准备发送
- 

#### CSMA/CA协议

可使用在无线LAN，处理了**隐蔽站问题**

- 源发送帧前侦听
  - 侦听直到空闲
  - 等待一段DIFS时间，然后栈发送一个控制帧RTS
- 目标接受到RTS后等待一段SIFS时间，发送一个控制帧CTS到源表示已经准备好接收数据
- 源接受到CTS后等待SIFS后发送数据
- 目标接收数据后等待SIFS后发送ACK给源

### 局域网 LANs

局域网特性由三个要素决定：拓扑结构、传输介质、介质访问控制方式

#### 拓扑结构

- 物理拓扑：物理连接的位置与布局
- 逻辑拓扑：



- 总线型
- 树形
- 星型
- 环型

### Ethernet

以太网，总线形、星型、树型拓扑，基带传输，CSMA/CD，IEEE802.3，





## 网络层 Network Layer  

<img src="计算机网络.assets/image-20210512152715984.png" alt="image-20210512152715984" style="zoom:67%;" />

### 网络层功能

#### 异构网络互联

#### 路由和转发

#### 拥塞控制

在通信子网中出现过量分组引起网络功能下降的现象称为拥塞

两种方法

- 开环控制
- 闭环控制

### 路由算法

路由器转发分组是通过路由表（Forwarding Table）实现的，路由算法可划分为

- 静态路由算法

  指由网络管理员手工配置路由信息

- 动态路由算法

  路由表项时通过相互连接的路由器之间彼此交换信息，然后按照一定的算法优化得出

  动态路由算法可分为

  - 

### IPV4

因特网可被视作异构网络的集合，网络层的IP协议将这些网络连接在一起

IP协议栈可以参考如下

<img src="计算机网络.assets/image-20210512154209357.png" alt="image-20210512154209357" style="zoom:67%;" />

IP协议格式栈参考如下

<img src="计算机网络.assets/image-20210512154324317.png" alt="image-20210512154324317" style="zoom:67%;" />

最大传输长度MTU：比较大的IP数据包会被划分，在最终目的地重组，示例如下

<img src="计算机网络.assets/image-20210512154619466.png" alt="image-20210512154619466" style="zoom:50%;" />

#### IP地址

32位，以“.”分隔

<img src="计算机网络.assets/image-20210512154817460.png" alt="image-20210512154817460" style="zoom:50%;" />

地址分类

<img src="计算机网络.assets/image-20210512155139188.png" alt="image-20210512155139188" style="zoom:67%;" />

要到达一个host

- 先找到NetworkID
- 再查找HostID

#### 子网

地址分类问题：所有在同一网络下的主机必须有同样的网络号

解决方案：将一个网络划分为子网，使世界只知道主网络，不知道子网

<img src="计算机网络.assets/image-20210512161003008.png" alt="image-20210512161003008" style="zoom:67%;" />

子网内的主机交流无需路由器转发

掩码：路由器在一个网络外通过网络地址路由，在网络内通过子网地址路由，路由器使用32位掩码来对网络地址进行认证

- 位=1：表示该位属于网络号
- 位=0：表示该位属于主机号

<img src="计算机网络.assets/image-20210512161738706.png" alt="image-20210512161738706" style="zoom:50%;" />

网络号= IP地址 AND 掩码

<img src="计算机网络.assets/image-20210512161829875.png" alt="image-20210512161829875" style="zoom:50%;" />

CIDR：网络区域路由，使用任意长度的子网部分，可讲几个网络构建一个更大范围的地址的网络

<img src="计算机网络.assets/image-20210512163718446.png" alt="image-20210512163718446" style="zoom: 50%;" />

#### NAT

一种防止IP耗尽的方法

讲专用网络地址转换为公用网络地址，对外隐藏内部管理的IP地址，专用网本地IP地址是可以重用的

### 路由协议

#### RIP路由信息协议

属于内部网关协议IGP，基于距离向量的路由选择协议

#### OSPF开放最短路径优先协议

属于内部网关协议IGP

与RIP的区别

- OSPF向系统内所有路由器发送信息（洪泛法），RIP仅向相邻路由器发送信息
- OSPF发送部分信息，RIP发送路由表
- OSPF只有当链路状态发生变化时，才会发送信息
- OSPF协议是网络层协议，RIP是传输层
- 

五种消息分组类型

- 问候分组

#### BGP边界网关协议

属于外部网关协议，采用路径向量路由选择协议，是应用层协议，属于TCP

### IPv6



## 传输层 

<img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20210606190916490.png" alt="image-20210606190916490" style="zoom:50%;" />

### 传输层提供的服务

传输层为不同主机上的进程见提供了逻辑通信

























